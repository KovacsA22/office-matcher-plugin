{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"run\").onclick = () => run();\n    document.getElementById(\"fill\").onclick = () => fillFromSelection();\n    document.getElementById(\"delete-output\").onclick = () => deleteOutput();\n    document.getElementById(\"select-words\").onclick = () => load(\"words-start\");\n    document.getElementById(\"select-texts\").onclick = () => load(\"texts-start\");\n    document.getElementById(\"select-results\").onclick = () => load(\"results-start\");\n    document.getElementById(\"select-delimiter\").onclick = () => load(\"delimiter-cell\");\n\n\n  }\n});\n\nlet delimiter=\"\", wordArray=[], textArray=[], wordCount, textCount, resultAddress;\n\n\nasync function fillFromSelection(){\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"values\");\n      await context.sync();\n\n      document.getElementById(\"words-start\").value=range.values[0][0];\n      document.getElementById(\"texts-start\").value=range.values[1][0];\n      document.getElementById(\"delimiter-cell\").value=range.values[2][0];\n      document.getElementById(\"results-start\").value=range.values[3][0];\n\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nasync function load(targetId){\n  try {\n    await Excel.run(async (context) => {\n      let range = context.workbook.getSelectedRange();\n      \n      range.load(\"address\");\n      await context.sync();\n      document.getElementById(targetId).value=range.address;\n      \n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n\nfunction getRange(context, address){\n  const parts = address.split(\"!\");\n  const worksheet = parts[0];\n  const cells = parts[1];\n  return context.workbook.worksheets.getItem(worksheet).getRange(cells);\n}\n\nfunction getRangeById(context, id){\n  const value = document.getElementById(id).value;\n  return getRange(context, value);\n}\n\n\n\nasync function processInputs(context){\n  // WORDS\n  {\n    let wordRange = getRangeById(context,\"words-start\");\n        \n    // Read the range address\n    wordRange.load(\"rowIndex\");\n    await context.sync();\n    \n    const top = wordRange.getOffsetRange(-wordRange.rowIndex,0);\n    //const top = context.workbook.worksheets.getActiveWorksheet().getCell(0,wordRange.columnIndex);\n\n    top.load(\"values\");\n    await context.sync();\n\n    wordCount = top.values[0][0];\n    document.getElementById(\"word-count\").innerText = wordCount + \" db\";\n\n    wordRange = wordRange.getResizedRange(wordCount-1,0);\n    //wordRange.select();\n    \n    wordRange.load(\"values\");\n    await context.sync();\n    wordArray=[];\n    for(const word of wordRange.values){\n      wordArray.push(word[0].toString().toLowerCase());\n    }\n  }  \n  //TEXTS\n    {\n    let textRange = getRangeById(context, \"texts-start\");\n\n    // Read the range address\n    textRange.load(\"rowIndex\");\n    await context.sync();\n    const top = textRange.getOffsetRange(-textRange.rowIndex,0);\n    //const top = context.workbook.worksheets.getActiveWorksheet().getCell(0,textRange.columnIndex);\n\n    top.load(\"values\");\n    await context.sync();\n\n    textCount = top.values[0][0];\n    document.getElementById(\"text-count\").innerText = textCount + \" db\";\n\n    textRange = textRange.getResizedRange(textCount-1,0);\n    //textRange.select();\n\n    textRange.load(\"values\");\n\n    await context.sync();\n    textArray=[];\n    for(const text of textRange.values){\n      textArray.push(text[0].toString().toLowerCase());\n    }\n  }\n  // RESULTS\n\n  resultAddress = document.getElementById(\"results-start\").value;\n\n  // DELIMITER\n\n  {\n    var delimiterRange = getRangeById(context, \"delimiter-cell\");\n    //let delimiterRange = context.workbook.worksheets.getActiveWorksheet().getRange(document.getElementById(\"delimiter-cell\").value.toString());\n    //let delimiterRange=context.workbook.worksheets.getItem(\"Sheet1\").getRange(\"G4:G4\");\n    delimiterRange.load(\"values\");\n    await context.sync();\n\n    \n    delimiter=delimiterRange.values[0][0];\n    document.getElementById(\"delimiter\").innerText = \"\\\"\"+delimiter+\"\\\"\";\n  }\n}\n\nasync function deleteOutput() {\n  try {\n    await Excel.run(async (context) => {\n      const outputStart = getRangeById(context, \"results-start\");\n      const outputColumns = outputStart.getResizedRange(0,16).getEntireColumn();\n      outputColumns.clear(\"Contents\");\n    });\n  } catch (error) {\n    console.error(error);\n    document.getElementById(\"error\").innerText=\"(Hiba: \"+error+\")\";\n  }\n}\nasync function run() {\n  try {\n    await Excel.run(async (context) => {\n      document.getElementById(\"error\").innerText=\"\";\n      const runButton = document.getElementById(\"run-text\");\n      runButton.innerText=\"Futtatás...\";\n      await processInputs(context);\n      const rootCell = getRange(context, resultAddress);\n      let activeCell = rootCell;\n\n      runButton.innerText=\"Futtatás... (1)\";\n      await context.sync();\n      await runSingleCounter(activeCell, false);\n      activeCell=rootCell.getOffsetRange(0,3);\n      await context.sync();\n\n      runButton.innerText=\"Futtatás... (2)\";\n      await context.sync();\n      await runSingleCounter(activeCell, true);\n      activeCell=rootCell.getOffsetRange(0,6);\n      await context.sync();\n\n      runButton.innerText=\"Futtatás... (3)\";\n      await runPairsCounter(activeCell);\n      await context.sync();\n      activeCell=rootCell.getOffsetRange(0,10);\n      runButton.innerText=\"Futtatás... (4)\";\n      \n      await runCountTags(activeCell);\n      await context.sync();\n      activeCell=rootCell.getOffsetRange(0,12);\n      runButton.innerText=\"Futtatás... (5)\";\n      \n      await runCreateHistogram(activeCell);\n      await context.sync();\n      activeCell=rootCell.getOffsetRange(0,15);\n      runButton.innerText=\"Futtatás... (6)\";\n      \n      await runCreateMatchHistogram(activeCell);\n      await context.sync();\n\n    });\n  } catch (error) {\n    console.error(error);\n    document.getElementById(\"error\").innerText=\"(Hiba: \"+error+\")\";\n\n  }finally{\n    document.getElementById(\"run-text\").innerText=\"Futtatás\";\n\n  }\n}\n\nfunction refreshElement(element){\n  element.style.display=\"none\";\n  element.style.display=\"block\";\n}\n\n\nasync function runSingleCounter(resultRange, ordered) {\n      let occurences = new Map();\n      for(const word of wordArray){\n        let occurence = 0;\n        for(const text of textArray){\n          //occurence += text[0].split(word[0]).length - 1;\n          //occurence += (text[0].match(new RegExp(word[0],\"gi\")) || []).length;\n          //occurence += (text[0].match(new RegExp(word[0],\"gi\")) || []).length>0?1:0;\n          occurence += text.includes(word);\n          continue;\n        }\n        occurences.set(word,occurence);\n      }\n      console.log(occurences);\n\n      if(ordered){\n        occurences = new Map([...occurences.entries()].sort((a, b) => b[1] - a[1]));\n      }\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(occurences.size-1,1);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const [word,count] of occurences){\n        resultRange.values.push([word,count]);\n      }\n      //await context.sync();\n\n}\n\n\nasync function runPairsCounter(resultRange) {\n      const occurences = {};\n        for(i=0;i<wordArray.length-1;i++){\n          for(j=i+1;j<wordArray.length;j++){\n            for(const text of textArray){\n            if(text.includes(wordArray[i]) && text.includes(wordArray[j])){\n              if(occurences[i+\"x\"+j]==undefined){\n                occurences[i+\"x\"+j]=0;\n              }\n              occurences[i+\"x\"+j]+=1;\n            }\n          }\n        }\n      }\n\n      console.log(occurences);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(Object.keys(occurences).length-1,2);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const key in occurences){\n        const keys = key.split(\"x\");\n        resultRange.values.push([parseInt(keys[0])+1,parseInt(keys[1])+1,occurences[key]]);\n      }\n\n}\n\nString.prototype.count = function(search) {\n  var m = this.match(new RegExp(search.toString().replace(/(?=[.\\\\+*?[^\\]$(){}\\|])/g, \"\\\\\"), \"gi\"));\n  return m ? m.length:0;\n}\n\nasync function runCountTags(resultRange) {\n      const occurences = [];\n      for(const text of textArray){\n        const array = text.split(delimiter);\n        if(array.length==1 && array[0]==\"\"){\n          occurences.push(0);\n        }else{\n          const occurence = text.split(delimiter).length;\n          occurences.push(occurence);\n        }\n      }\n\n      console.log(occurences);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(occurences.length-1,0);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const occurence of occurences){\n        resultRange.values.push([occurence]);\n      }\n\n}\n\n\nasync function runCreateHistogram(resultRange) {\n      let maxTagCount=0;\n      const tagCounts = {};\n      for(const text of textArray){\n        const array = text.split(delimiter);\n        let tagCount=0;\n        if(array.length !=1 || array[0] != \"\"){\n          tagCount = text.split(delimiter).length;\n        }\n        if(tagCount>maxTagCount){\n          maxTagCount=tagCount;\n        }\n        if(tagCounts[tagCount+\"\"] == undefined){\n          tagCounts[tagCount+\"\"] = 0;\n        }\n        tagCounts[tagCount+\"\"] += 1;\n        \n      }\n\n      console.log(tagCounts);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(maxTagCount,1);\n      //resultRange.select();\n      resultRange.values=[];\n      for(i=0;i<=maxTagCount;i++){\n        resultRange.values.push([i,tagCounts[i+\"\"]==undefined?0:tagCounts[i+\"\"]]);\n      }\n\n}\n\n\nasync function runCreateMatchHistogram(resultRange) {\n\n        const occurences = [];\n        for(const text of textArray){\n          let occurence = 0;\n          for(const word of wordArray){\n            occurence += text.count(word);//(text.match(new RegExp(word,\"gi\")) || []).length;\n          }\n          occurences.push(occurence);\n          //occurences.push(occurence);\n        }\n\n        console.log(occurences);\n\n        //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n        resultRange=resultRange.getResizedRange(occurences.length,1);\n        //resultRange.select();\n        resultRange.values=[];\n        for(i=0;i<=occurences.length;i++){\n          resultRange.values.push([i+1,occurences[i]==undefined?0:occurences[i]]);\n        }\n        /*for(const occurence in occurences){\n          resultRange.values.push([occurence,occurences[occurence]]);\n        }*/\n\n\n}\n\n\n\n"],"names":["Office","onReady","info","host","HostType","Excel","document","getElementById","style","display","onclick","run","fillFromSelection","deleteOutput","load","wordCount","textCount","resultAddress","delimiter","wordArray","textArray","context","range","workbook","getSelectedRange","sync","value","values","console","error","targetId","address","getRange","parts","split","worksheet","cells","worksheets","getItem","getRangeById","id","processInputs","wordRange","top","getOffsetRange","rowIndex","innerText","getResizedRange","word","push","toString","toLowerCase","textRange","text","delimiterRange","getEntireColumn","clear","runButton","rootCell","activeCell","runSingleCounter","runPairsCounter","runCountTags","runCreateHistogram","runCreateMatchHistogram","resultRange","ordered","occurences","Map","occurence","includes","set","log","entries","sort","a","b","size","count","i","length","j","undefined","key","Object","keys","parseInt","array","maxTagCount","tagCounts","tagCount","String","prototype","search","m","this","match","RegExp","replace"],"sourceRoot":""}