{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"run\").onclick = () => run();\n    document.getElementById(\"fill\").onclick = () => fillFromSelection();\n    document.getElementById(\"select-words\").onclick = () => load(\"words-start\");\n    document.getElementById(\"select-texts\").onclick = () => load(\"texts-start\");\n    document.getElementById(\"select-results\").onclick = () => load(\"results-start\");\n    document.getElementById(\"select-delimiter\").onclick = () => load(\"delimiter-cell\");\n\n\n  }\n});\n\nlet delimiter=\"\", wordArray=[], textArray=[], wordCount, textCount, resultAddress;\n\n\nasync function fillFromSelection(){\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"values\");\n      await context.sync();\n\n      document.getElementById(\"words-start\").value=range.values[0][0];\n      document.getElementById(\"texts-start\").value=range.values[1][0];\n      document.getElementById(\"delimiter-cell\").value=range.values[2][0];\n      document.getElementById(\"results-start\").value=range.values[3][0];\n\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nasync function load(targetId){\n  try {\n    await Excel.run(async (context) => {\n      let range = context.workbook.getSelectedRange();\n      \n      range.load(\"address\");\n      await context.sync();\n      document.getElementById(targetId).value=range.address;\n      \n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n\nfunction getRange(context, address){\n  const parts = address.split(\"!\");\n  const worksheet = parts[0];\n  const cells = parts[1];\n  return context.workbook.worksheets.getItem(worksheet).getRange(cells);\n}\n\nfunction getRangeById(context, id){\n  const value = document.getElementById(id).value;\n  return getRange(context, value);\n}\n\n\n\nasync function processInputs(context){\n  // WORDS\n  {\n    let wordRange = getRangeById(context,\"words-start\");\n        \n    // Read the range address\n    wordRange.load(\"rowIndex\");\n    await context.sync();\n    \n    const top = wordRange.getOffsetRange(-wordRange.rowIndex,0);\n    //const top = context.workbook.worksheets.getActiveWorksheet().getCell(0,wordRange.columnIndex);\n\n    top.load(\"values\");\n    await context.sync();\n\n    wordCount = top.values[0][0];\n    document.getElementById(\"word-count\").innerText = wordCount + \" db\";\n\n    wordRange = wordRange.getResizedRange(wordCount-1,0);\n    //wordRange.select();\n    \n    wordRange.load(\"values\");\n    await context.sync();\n    wordArray=[];\n    for(const word of wordRange.values){\n      wordArray.push(word[0].toString().toLowerCase());\n    }\n  }  \n  //TEXTS\n    {\n    let textRange = getRangeById(context, \"texts-start\");\n\n    // Read the range address\n    textRange.load(\"rowIndex\");\n    await context.sync();\n    const top = textRange.getOffsetRange(-textRange.rowIndex,0);\n    //const top = context.workbook.worksheets.getActiveWorksheet().getCell(0,textRange.columnIndex);\n\n    top.load(\"values\");\n    await context.sync();\n\n    textCount = top.values[0][0];\n    document.getElementById(\"text-count\").innerText = textCount + \" db\";\n\n    textRange = textRange.getResizedRange(textCount-1,0);\n    //textRange.select();\n\n    textRange.load(\"values\");\n\n    await context.sync();\n    textArray=[];\n    for(const text of textRange.values){\n      textArray.push(text[0].toString().toLowerCase());\n    }\n  }\n  // RESULTS\n\n  resultAddress = document.getElementById(\"results-start\").value;\n\n  // DELIMITER\n\n  {\n    var delimiterRange = getRangeById(context, \"delimiter-cell\");\n    //let delimiterRange = context.workbook.worksheets.getActiveWorksheet().getRange(document.getElementById(\"delimiter-cell\").value.toString());\n    //let delimiterRange=context.workbook.worksheets.getItem(\"Sheet1\").getRange(\"G4:G4\");\n    delimiterRange.load(\"values\");\n    await context.sync();\n\n    \n    delimiter=delimiterRange.values[0][0];\n    document.getElementById(\"delimiter\").innerText = \"\\\"\"+delimiter+\"\\\"\";\n  }\n}\n\nasync function run() {\n  try {\n    await Excel.run(async (context) => {\n      document.getElementById(\"run-text\").innerText=\"Futtatás...\";\n      await processInputs(context);\n      const rootCell = getRange(context, resultAddress);\n      let activeCell = rootCell;\n\n      await runSingleCounter(activeCell);\n      activeCell=rootCell.getOffsetRange(0,2);\n      await runPairsCounter(activeCell);\n      activeCell=rootCell.getOffsetRange(0,6);\n      await runCountTags(activeCell);\n      activeCell=rootCell.getOffsetRange(0,8);\n      await runCreateHistogram(activeCell);\n      activeCell=rootCell.getOffsetRange(0,11);\n      await runCreateMatchHistogram(activeCell);\n\n\n      document.getElementById(\"run-text\").innerText=\"Futtatás\";\n    });\n  } catch (error) {\n    console.error(error);\n    document.getElementById(\"run-text\").innerText=\"Futtatás\\n(hiba:\"+error+\")\";\n\n  }\n}\n\n\nasync function runSingleCounter(resultRange) {\n      const occurences = [];\n      for(const word of wordArray){\n        let occurence = 0;\n        for(const text of textArray){\n          //occurence += text[0].split(word[0]).length - 1;\n          //occurence += (text[0].match(new RegExp(word[0],\"gi\")) || []).length;\n          //occurence += (text[0].match(new RegExp(word[0],\"gi\")) || []).length>0?1:0;\n          occurence += text.includes(word);\n          continue;\n        }\n        occurences.push(occurence);\n      }\n      console.log(occurences);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(occurences.length-1,0);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const occurence of occurences){\n        resultRange.values.push([occurence]);\n      }\n      //await context.sync();\n\n}\n\n\nasync function runPairsCounter(resultRange) {\n      const occurences = {};\n        for(i=0;i<wordArray.length-1;i++){\n          for(j=i+1;j<wordArray.length;j++){\n            for(const text of textArray){\n            if(text.includes(wordArray[i]) && text.includes(wordArray[j])){\n              if(occurences[i+\"x\"+j]==undefined){\n                occurences[i+\"x\"+j]=0;\n              }\n              occurences[i+\"x\"+j]+=1;\n            }\n          }\n        }\n      }\n\n      console.log(occurences);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(Object.keys(occurences).length-1,2);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const key in occurences){\n        const keys = key.split(\"x\");\n        resultRange.values.push([parseInt(keys[0])+1,parseInt(keys[1])+1,occurences[key]]);\n      }\n\n}\n\nString.prototype.count = function(search) {\n  var m = this.match(new RegExp(search.toString().replace(/(?=[.\\\\+*?[^\\]$(){}\\|])/g, \"\\\\\"), \"gi\"));\n  return m ? m.length:0;\n}\n\nasync function runCountTags(resultRange) {\n      const occurences = [];\n      for(const text of textArray){\n        const array = text.split(delimiter);\n        if(array.length==1 && array[0]==\"\"){\n          occurences.push(0);\n        }else{\n          const occurence = text.split(delimiter).length;\n          occurences.push(occurence);\n        }\n      }\n\n      console.log(occurences);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(occurences.length-1,0);\n      //resultRange.select();\n      resultRange.values=[];\n      for(const occurence of occurences){\n        resultRange.values.push([occurence]);\n      }\n\n}\n\n\nasync function runCreateHistogram(resultRange) {\n      let maxTagCount=0;\n      const tagCounts = {};\n      for(const text of textArray){\n        const array = text.split(delimiter);\n        let tagCount=0;\n        if(array.length !=1 || array[0] != \"\"){\n          tagCount = text.split(delimiter).length;\n        }\n        if(tagCount>maxTagCount){\n          maxTagCount=tagCount;\n        }\n        if(tagCounts[tagCount+\"\"] == undefined){\n          tagCounts[tagCount+\"\"] = 0;\n        }\n        tagCounts[tagCount+\"\"] += 1;\n        \n      }\n\n      console.log(tagCounts);\n\n      //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n      resultRange=resultRange.getResizedRange(maxTagCount,1);\n      //resultRange.select();\n      resultRange.values=[];\n      for(i=0;i<=maxTagCount;i++){\n        resultRange.values.push([i,tagCounts[i+\"\"]==undefined?0:tagCounts[i+\"\"]]);\n      }\n\n}\n\n\nasync function runCreateMatchHistogram(resultRange) {\n\n        const occurences = [];\n        for(const text of textArray){\n          let occurence = 0;\n          for(const word of wordArray){\n            occurence += text.count(word);//(text.match(new RegExp(word,\"gi\")) || []).length;\n          }\n          occurences.push(occurence);\n          //occurences.push(occurence);\n        }\n\n        console.log(occurences);\n\n        //let resultRange = context.workbook.worksheets.getActiveWorksheet().getRange(resultAddress);\n        resultRange=resultRange.getResizedRange(occurences.length,1);\n        //resultRange.select();\n        resultRange.values=[];\n        for(i=0;i<=occurences.length;i++){\n          resultRange.values.push([i+1,occurences[i]==undefined?0:occurences[i]]);\n        }\n        /*for(const occurence in occurences){\n          resultRange.values.push([occurence,occurences[occurence]]);\n        }*/\n\n\n}\n\n\n\n"],"names":["Office","onReady","info","host","HostType","Excel","document","getElementById","style","display","onclick","run","fillFromSelection","load","wordCount","textCount","resultAddress","delimiter","wordArray","textArray","context","range","workbook","getSelectedRange","sync","value","values","console","error","targetId","address","getRange","parts","split","worksheet","cells","worksheets","getItem","getRangeById","id","processInputs","wordRange","top","getOffsetRange","rowIndex","innerText","getResizedRange","word","push","toString","toLowerCase","textRange","text","delimiterRange","rootCell","activeCell","runSingleCounter","runPairsCounter","runCountTags","runCreateHistogram","runCreateMatchHistogram","resultRange","occurences","occurence","includes","log","length","i","j","undefined","key","Object","keys","parseInt","array","maxTagCount","tagCounts","tagCount","count","String","prototype","search","m","this","match","RegExp","replace"],"sourceRoot":""}